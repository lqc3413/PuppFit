import{_ as U,r as i,i as D,b as l,o,e as s,f as C,t,x as w,F as m,k as f,n as F,w as T,g as b,v as L,z as x}from"./index-jU6pvMoE.js";import{a as _}from"./index-B9ygI19o.js";const S={class:"page-container"},$={class:"page-header"},q={class:"header-left"},z={class:"count-badge"},A={class:"cards-grid"},E={class:"card-header"},R={class:"class-name"},P={class:"grade-tag"},j={class:"card-body"},G={class:"info-row"},H={class:"info-row"},J={class:"info-value"},K={class:"info-row"},O={class:"info-value"},Q={class:"card-footer"},W=["onClick"],X=["onClick"],Y={key:0,class:"empty-card"},Z={class:"modal-box"},ss={class:"modal-title"},es={class:"form-group"},as={class:"form-group"},ts=["value"],ls={class:"form-group"},os=["value"],ns={class:"modal-actions"},ds={type:"submit",class:"submit-btn"},is={class:"modal-box small"},us={class:"bind-info"},rs=["value"],cs={__name:"ClassList",setup(vs){const c=i([]),h=i([]),g=i(!1),u=i(!1),k=i(!1),d=i({name:"",grade:1,headTeacherId:null}),v=i(null),p=i(null),y=async()=>{const[n,e]=await Promise.all([_.get("/api/admin/classes"),_.get("/api/admin/teachers")]);n.data.code===200&&(c.value=n.data.data),e.data.code===200&&(h.value=e.data.data.filter(a=>a.status==="active"))},I=n=>{d.value={...n},u.value=!0},M=n=>{v.value=n,p.value=n.headTeacherId,k.value=!0},V=async()=>{const n=u.value?"/api/admin/class/update":"/api/admin/class/add";await _.post(n,d.value),r(),y()},B=async()=>{await _.post("/api/admin/class/update",{id:v.value.id,headTeacherId:p.value}),r(),y()},r=()=>{g.value=!1,u.value=!1,k.value=!1,d.value={name:"",grade:1,headTeacherId:null},v.value=null};return D(y),(n,e)=>(o(),l("div",S,[s("div",$,[s("div",q,[e[5]||(e[5]=s("h2",{class:"page-title"},"班级管理",-1)),s("span",z,"共 "+t(c.value.length)+" 个班级",1)]),s("button",{class:"primary-btn",onClick:e[0]||(e[0]=a=>g.value=!0)},[...e[6]||(e[6]=[s("span",null,"➕",-1),w(" 新建班级 ",-1)])])]),s("div",A,[(o(!0),l(m,null,f(c.value,a=>(o(),l("div",{key:a.id,class:"class-card"},[s("div",E,[s("span",R,t(a.name),1),s("span",P,t(a.grade)+"年级",1)]),s("div",j,[s("div",G,[e[7]||(e[7]=s("span",{class:"info-label"},"班主任",-1)),s("span",{class:F(["info-value",{"not-assigned":!a.headTeacherId}])},t(a.headTeacherName),3)]),s("div",H,[e[8]||(e[8]=s("span",{class:"info-label"},"学生人数",-1)),s("span",J,t(a.studentCount)+" 人",1)]),s("div",K,[e[9]||(e[9]=s("span",{class:"info-label"},"创建时间",-1)),s("span",O,t(a.createdAt),1)])]),s("div",Q,[s("button",{class:"link-btn",onClick:N=>I(a)},"编辑",8,W),s("button",{class:"link-btn",onClick:N=>M(a)},"绑定班主任",8,X)])]))),128)),c.value.length===0?(o(),l("div",Y," 暂无班级数据 ")):C("",!0)]),g.value||u.value?(o(),l("div",{key:0,class:"modal-overlay",onClick:T(r,["self"])},[s("div",Z,[s("h3",ss,t(u.value?"编辑班级":"新建班级"),1),s("form",{onSubmit:T(V,["prevent"])},[s("div",es,[e[10]||(e[10]=s("label",null,"班级名称 *",-1)),b(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>d.value.name=a),type:"text",placeholder:"如: 三年级一班",required:""},null,512),[[L,d.value.name]])]),s("div",as,[e[11]||(e[11]=s("label",null,"年级 *",-1)),b(s("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>d.value.grade=a),required:""},[(o(),l(m,null,f(6,a=>s("option",{key:a,value:a},t(a)+"年级",9,ts)),64))],512),[[x,d.value.grade]])]),s("div",ls,[e[13]||(e[13]=s("label",null,"班主任",-1)),b(s("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>d.value.headTeacherId=a)},[e[12]||(e[12]=s("option",{value:null},"暂不分配",-1)),(o(!0),l(m,null,f(h.value,a=>(o(),l("option",{key:a.id,value:a.id},t(a.name),9,os))),128))],512),[[x,d.value.headTeacherId]])]),s("div",ns,[s("button",{type:"button",class:"cancel-btn",onClick:r},"取消"),s("button",ds,t(u.value?"保存":"创建"),1)])],32)])])):C("",!0),k.value?(o(),l("div",{key:1,class:"modal-overlay",onClick:T(r,["self"])},[s("div",is,[e[17]||(e[17]=s("h3",{class:"modal-title"},"绑定班主任",-1)),s("p",us,[e[14]||(e[14]=w("为 ",-1)),s("strong",null,t(v.value?.name),1),e[15]||(e[15]=w(" 选择班主任：",-1))]),b(s("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>p.value=a),class:"full-select"},[e[16]||(e[16]=s("option",{value:null},"暂不分配",-1)),(o(!0),l(m,null,f(h.value,a=>(o(),l("option",{key:a.id,value:a.id},t(a.name),9,rs))),128))],512),[[x,p.value]]),s("div",{class:"modal-actions"},[s("button",{type:"button",class:"cancel-btn",onClick:r},"取消"),s("button",{type:"button",class:"submit-btn",onClick:B},"确认")])])])):C("",!0)]))}},fs=U(cs,[["__scopeId","data-v-02e843f8"]]);export{fs as default};
